<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offload Timeline Viewer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š Offload Timeline Viewer</h1>
        
        <div id="authContainer" class="auth-container">
            <h3>Sign In</h3>
            <div id="authForm" class="auth-form">
                <input type="email" id="emailInput" placeholder="Email">
                <input type="password" id="passwordInput" placeholder="Password">
                <button onclick="signIn()">Sign In</button>
                <button onclick="signUp()" style="background: #059669;">Create Account</button>
            </div>
            <div id="userInfo" class="user-info" style="display: none;">
                <span id="userEmail"></span>
                <button onclick="signOut()" style="background: #dc2626; margin-left: 12px;">Sign Out</button>
            </div>
        </div>
        
        <div class="app-content" id="appContent">
            <div class="instructions">
                <h3>How to use:</h3>
                <p>1. In your Offload app, copy your CSV data<br>
                2. Paste the CSV data into the box below<br>
                3. Click "Generate Timeline" to visualize your data<br>
                4. Click "Save Dataset" to save it to the cloud<br>
                5. Use "Load Dataset" to load previously saved datasets<br>
                6. Hover over any slice to see details</p>
            </div>
            
            <div id="timeline"></div>
            
            <div id="mergeDialog" style="display: none; background: #f0f9ff; border: 2px solid #0891b2; border-radius: 8px; padding: 16px; margin-top: 20px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 12px; color: #0891b2;">Import & Merge New Data</h3>
                <p style="margin-bottom: 12px; font-size: 14px;">Paste new CSV data below. It will be merged with your cloud dataset.</p>
                <textarea id="mergeInput" placeholder="Paste new CSV data here..." style="width: 100%; height: 120px; padding: 12px; border: 2px solid #0891b2; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 13px; margin-bottom: 12px;"></textarea>
                <div style="display: flex; gap: 12px;">
                    <button onclick="performMerge()" style="background: #0891b2;">Merge & Upload</button>
                    <button onclick="closeMergeDialog()" style="background: #6b7280;">Cancel</button>
                </div>
                <div id="mergeStatus" style="margin-top: 12px; padding: 12px; background: white; border-radius: 6px; font-size: 13px; font-family: 'Courier New', monospace; display: none; max-height: 200px; overflow-y: auto;"></div>
            </div>
            
            <textarea id="dataInput" placeholder="Paste your CSV data here..."></textarea>
            
            <div style="display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap;">
                <button onclick="generateTimeline()">Generate Timeline</button>
                <button onclick="deduplicateData()" style="background: #f59e0b;">ğŸ§¹ Remove Duplicates</button>
                <button onclick="clearData()" style="background: #dc2626;">ğŸ—‘ï¸ Clear Data</button>
                <button onclick="showMergeDialog()" style="background: #0891b2;">ğŸ”„ Import & Merge</button>
                <input type="text" id="datasetName" placeholder="Dataset name (e.g., 'Jan 2026 Data')" style="flex: 1; min-width: 250px; padding: 12px; border: 2px solid #d1d5db; border-radius: 8px;">
                <button onclick="saveDataset()" style="background: #059669;">ğŸ’¾ Save Dataset</button>
                <button onclick="showLoadMenu()" style="background: #7c3aed;">ğŸ“‚ Load Dataset</button>
            </div>
            
            <div id="loadMenu" style="display: none; background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 12px;">Saved Datasets:</h3>
                <div id="datasetList"></div>
            </div>
            
            <div id="debugPanel" style="background: #fef2f2; border: 2px solid #dc2626; border-radius: 8px; padding: 16px; margin-bottom: 20px; display: none;">
                <h3 style="margin-bottom: 8px; color: #991b1b;">Debug Information</h3>
                <div id="debugLog" style="font-family: 'Courier New', monospace; font-size: 12px; max-height: 200px; overflow-y: auto; white-space: pre-wrap;"></div>
                <button onclick="document.getElementById('debugPanel').style.display='none'" style="margin-top: 8px; padding: 6px 12px; font-size: 14px; background: #6b7280;">Close</button>
            </div>
        </div>
    </div>
    
    <div id="tooltip" class="tooltip"></div>
    
    <script type="module" src="app.js"></script>
</body>
</html>
